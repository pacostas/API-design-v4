{"pageProps":{"post":{"attributes":{},"html":"<p>Now that we have our schema and data models, we can start creating routes and route handlers to interact with those models. We&#39;ll be following a mostly RESTful approach to our API design, but as you&#39;ll soon learn, nothing ever stays the course when it comes to REST.</p>\n<h2 id=\"thinking-of-routes\">Thinking of routes</h2>\n<p>Until some other need presents itself, for the most part, we want to create a route for every CRUD action for every resource. So, take a Product for example, we want to create:</p>\n<ul>\n<li><code>GET product/:id</code> - get a product by a given ID</li>\n<li><code>GET product</code> - get all the products (for an authenticated user)</li>\n<li><code>POST product</code> - create a new product</li>\n<li><code>PUT product/:id</code> - update or replace a product that matches a given ID</li>\n<li><code>DELETE product/:id</code> - delete a product by a give ID</li>\n</ul>\n<p>This is how REST looks. However, when developing an API that&#39;s consumed only by a client that you and your team also created, using something like REST is probably redundant and tedious. There&#39;s nothing stopping you from just creating an API route to get all the data for every page, or every component, or whatever makes sense for your UI app. Something like REST is great for external APIs so that external developers can onboard more quickly because they know what to expect vs having to learn some custom API design.</p>\n<h2 id=\"create-our-routes\">Create our routes</h2>\n<p>Create a new file, <code>src/router.ts</code> and work in there.</p>\n<pre><code class=\"hljs language-ts\"><span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">Router</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;express&quot;</span>;\n\n<span class=\"hljs-keyword\">const</span> router = <span class=\"hljs-title class_\">Router</span>();\n<span class=\"hljs-comment\">/**\n * Product\n */</span>\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&quot;/product&quot;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">json</span>({ <span class=\"hljs-attr\">message</span>: <span class=\"hljs-string\">&quot;product&quot;</span> });\n});\n\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&quot;/product/:id&quot;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {});\n\nrouter.<span class=\"hljs-title function_\">post</span>(<span class=\"hljs-string\">&quot;/product&quot;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {});\n\nrouter.<span class=\"hljs-title function_\">put</span>(<span class=\"hljs-string\">&quot;/product/:id&quot;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {});\n\nrouter.<span class=\"hljs-title function_\">delete</span>(<span class=\"hljs-string\">&quot;/product/:id&quot;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {});\n\n<span class=\"hljs-comment\">/**\n * Update\n */</span>\n\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&quot;/update&quot;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {});\n\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&quot;/update/:id&quot;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {});\n\nrouter.<span class=\"hljs-title function_\">post</span>(<span class=\"hljs-string\">&quot;/update&quot;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {});\n\nrouter.<span class=\"hljs-title function_\">put</span>(<span class=\"hljs-string\">&quot;/update/:id&quot;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {});\n\nrouter.<span class=\"hljs-title function_\">delete</span>(<span class=\"hljs-string\">&quot;/update/:id&quot;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {});\n\n<span class=\"hljs-comment\">/**\n * UpdatePoint\n */</span>\n\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&quot;/updatepoint&quot;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {});\n\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&quot;/updatepoint/:id&quot;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {});\n\nrouter.<span class=\"hljs-title function_\">post</span>(<span class=\"hljs-string\">&quot;/updatepoint&quot;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {});\n\nrouter.<span class=\"hljs-title function_\">put</span>(<span class=\"hljs-string\">&quot;/updatepoint/:id&quot;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {});\n\nrouter.<span class=\"hljs-title function_\">delete</span>(<span class=\"hljs-string\">&quot;/updatepoint/:id&quot;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {});\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> router;\n</code></pre>\n<p>Few things going on here, first we created a new router using express. This just gives us more flexibility around configuring a set of routes vs the whole API. You can create as many routers as you&#39;d like with express and mount them back to the main express app on whatever paths you&#39;d like.\n<br>\nThen we created all the routes for the DB resources we want to interact with. User is noticiably missing. This is because User will have a special set of routes because of how important that resource is. For the handlers, we just put placeholder functions in there that do nothing. If you try to make an API call right now, your API will get back a <code>404</code> status code and some HTML (default 404 response from express). That&#39;s because we didn&#39;t mount this router back to the main express app. So it&#39;s just floating and not actually attached to our API.\nLet&#39;s do that next\n<br>\nhead over to <code>src/server.ts</code>:</p>\n<pre><code class=\"hljs language-ts\"><span class=\"hljs-keyword\">import</span> router <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;./router&#x27;</span>\n\n.......\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&#x27;/api&#x27;</span>, router)\n</code></pre>\n<p>Import the router from the other file and remove any current route declerations in server.ts. We then use something new here, <code>app.use()</code>, this just allows you to apply something like a router or middleware (will learn this later) to the entire API or in our case, to anything using the path <code>/api</code>. So a route we creating in the router like <code>GET /product</code>, is now actually <code>GET /api/product</code> because that router is mounted on the <code>/api</code> path.\n<br>\nYou should now be able to hit your API and not get a 404, but, it still won&#39;t work. What&#39;s happening now is that your API is hanging which just means it never responded back to the request and there is no more code to execute. The client will eventually timeout and close the connection. This happens because we never send a response in any of the handler functions we created. We&#39;ll do that soon, for now, lets talk about middleware.</p>\n","slug":"creating-routes","title":"Creating Routes","section":"Routes and Middleware","icon":"arrows-alt","filePath":"/home/runner/work/API-design-v4/API-design-v4/lessons/06-routes-and-middleware/A-creating-routes.md","nextSlug":"/API-design-v4/lessons/routes-and-middleware/middleware","prevSlug":"/API-design-v4/lessons/data-modeling/first-migrations"}},"__N_SSG":true}